<div class="container mx-auto px-4 py-8">
    <div class="max-w-4xl mx-auto">
        <div class="bg-white rounded-lg shadow-sm border">
            <div class="p-6 border-b">
                <h1 class="text-xl font-bold">{{ isEditing ? 'Edit Patient' : 'Register New Patient' }}</h1>
                <p class="text-sm text-gray-500">
                    {{ isEditing ? 'Update patient information in the system' : 'Enter patient details to register them
                    in the system' }}
                </p>
            </div>

            <div class="p-6">
                <form [formGroup]="patientForm" (ngSubmit)="onSubmit()" class="space-y-6">
                    <!-- Personal Information Section -->
                    <div>
                        <h2 class="text-lg font-semibold mb-4">Personal Information</h2>

                        <div formGroupName="name" class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <!-- First Name -->
                            <div class="form-field">
                                <label class="form-label">
                                    First Name <span class="text-red-500">*</span>
                                </label>
                                <input type="text" formControlName="firstName" class="form-input"
                                    [ngClass]="{'input-error': isNameFieldInvalid('firstName')}"
                                    placeholder="First Name" required />
                                <div *ngIf="isNameFieldInvalid('firstName')" class="error-message">
                                    First name is required and must be at least 3 characters.
                                </div>
                            </div>

                            <!-- Middle Name -->
                            <div class="form-field">
                                <label class="form-label">Middle Name</label>
                                <input type="text" formControlName="middleName" class="form-input"
                                    placeholder="Middle Name" />
                            </div>

                            <!-- Last Name -->
                            <div class="form-field">
                                <label class="form-label">
                                    Last Name <span class="text-red-500">*</span>
                                </label>
                                <input type="text" formControlName="lastName" class="form-input"
                                    [ngClass]="{'input-error': isNameFieldInvalid('lastName')}" placeholder="Last Name"
                                    required />
                                <div *ngIf="isNameFieldInvalid('lastName')" class="error-message">
                                    Last name is required and must be at least 3 characters.
                                </div>
                            </div>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mt-4">
                            <!-- Date of Birth -->
                            <div class="form-field">
                                <label class="form-label">
                                    Date of Birth <span class="text-red-500">*</span>
                                </label>
                                <input type="date" formControlName="birthdate" class="form-input"
                                    [max]="today"
                                    [ngClass]="{'input-error': isFieldInvalid('birthdate')}" required />
                                <div *ngIf="isFieldInvalid('birthdate')" class="error-message">
                                    Date of birth is required.
                                </div>
                            </div>

                            <!-- Gender -->
                            <div class="form-field">
                                <label class="form-label">
                                    Gender <span class="text-red-500">*</span>
                                </label>
                                <select formControlName="gender" class="form-select"
                                    [ngClass]="{'input-error': isFieldInvalid('gender')}" required>
                                    <option [ngValue]="''">Select gender</option>
                                    <option *ngFor="let gender of genders" [value]="gender">{{ gender }}</option>
                                </select>
                                <div *ngIf="isFieldInvalid('gender')" class="error-message">
                                    Gender is required.
                                </div>
                            </div>

                            <!-- Blood Group -->
                            <div class="form-field">
                                <label class="form-label">
                                    Blood Group <span class="text-red-500">*</span>
                                </label>
                                <select formControlName="bloodGroup" class="form-select"
                                    [ngClass]="{'input-error': isFieldInvalid('bloodGroup')}" required>
                                    <option [ngValue]="''">Select blood group</option>
                                    <option *ngFor="let group of bloodGroups" [value]="group">{{ group }}</option>
                                </select>
                                <div *ngIf="isFieldInvalid('bloodGroup')" class="error-message">
                                    Blood group is required.
                                </div>
                            </div>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4">
                            <!-- Email -->
                            <div class="form-field">
                                <label class="form-label">
                                    Email <span class="text-red-500">*</span>
                                </label>
                                <input type="email" formControlName="email" class="form-input" placeholder="Email"
                                    [ngClass]="{'input-error': isFieldInvalid('email')}" required />
                                <div *ngIf="isFieldInvalid('email')" class="error-message">
                                    Please enter a valid email address.
                                </div>
                            </div>

                            <!-- Mobile Number -->
                            <div class="form-field">
                                <label class="form-label">Mobile Number</label>
                                <input type="tel" formControlName="mobileNo" class="form-input"
                                    placeholder="Mobile Number"
                                    [ngClass]="{'input-error': isFieldInvalid('mobileNo')}" />
                                <div *ngIf="isFieldInvalid('mobileNo')" class="error-message">
                                    Please enter a valid 10-digit mobile number.
                                </div>
                            </div>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4">
                            <!-- Marital Status -->
                            <div class="form-field">
                                <label class="form-label">
                                    Marital Status <span class="text-red-500">*</span>
                                </label>
                                <select formControlName="maritalStatus" class="form-select"
                                    [ngClass]="{'input-error': isFieldInvalid('maritalStatus')}" required>
                                    <option [ngValue]="''">Select marital status</option>
                                    <option *ngFor="let status of maritalStatuses" [value]="status">{{ status }}
                                    </option>
                                </select>
                                <div *ngIf="isFieldInvalid('maritalStatus')" class="error-message">
                                    Marital status is required.
                                </div>
                            </div>

                            <!-- Occupation -->
                            <div class="form-field">
                                <label class="form-label">Occupation</label>
                                <input type="text" formControlName="occupation" class="form-input"
                                    placeholder="Occupation" />
                            </div>
                        </div>
                    </div>

                    <!-- Address Section -->
                    <div>
                        <h2 class="text-lg font-semibold mb-4">Address</h2>

                        <div formGroupName="address" class="space-y-4">
                            <!-- Street -->
                            <div class="form-field">
                                <label class="form-label">
                                    Street <span class="text-red-500">*</span>
                                </label>
                                <input type="text" formControlName="street" class="form-input" placeholder="Street"
                                    [ngClass]="{'input-error': isAddressFieldInvalid('street')}" required />
                                <div *ngIf="isAddressFieldInvalid('street')" class="error-message">
                                    Street is required.
                                </div>
                            </div>

                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <!-- City -->
                                <div class="form-field">
                                    <label class="form-label">
                                        City <span class="text-red-500">*</span>
                                    </label>
                                    <input type="text" formControlName="city" class="form-input" placeholder="City"
                                        [ngClass]="{'input-error': isAddressFieldInvalid('city')}" required />
                                    <div *ngIf="isAddressFieldInvalid('city')" class="error-message">
                                        City is required.
                                    </div>
                                </div>

                                <!-- State -->
                                <div class="form-field">
                                    <label class="form-label">
                                        State <span class="text-red-500">*</span>
                                    </label>
                                    <input type="text" formControlName="state" class="form-input" placeholder="State"
                                        [ngClass]="{'input-error': isAddressFieldInvalid('state')}" required />
                                    <div *ngIf="isAddressFieldInvalid('state')" class="error-message">
                                        State is required.
                                    </div>
                                </div>
                            </div>

                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <!-- Postal Code -->
                                <div class="form-field">
                                    <label class="form-label">
                                        Postal Code <span class="text-red-500">*</span>
                                    </label>
                                    <input type="text" formControlName="postalCode" class="form-input"
                                        placeholder="Postal Code"
                                        [ngClass]="{'input-error': isAddressFieldInvalid('postalCode')}" required />
                                    <div *ngIf="isAddressFieldInvalid('postalCode')" class="error-message">
                                        Postal code is required.
                                    </div>
                                </div>

                                <!-- Country -->
                                <div class="form-field">
                                    <label class="form-label">
                                        Country <span class="text-red-500">*</span>
                                    </label>
                                    <input type="text" formControlName="country" class="form-input"
                                        placeholder="Country"
                                        [ngClass]="{'input-error': isAddressFieldInvalid('country')}" required />
                                    <div *ngIf="isAddressFieldInvalid('country')" class="error-message">
                                        Country is required.
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Form Actions -->
                    <div class="flex justify-end space-x-4">
                        <button type="button" (click)="router.navigate(['/dashboard/patients'])"
                            class="px-4 py-2 border border-gray-300 rounded-md text-sm font-medium hover:bg-gray-50"
                            [disabled]="isLoading">
                            Cancel
                        </button>
                        <button type="submit" [disabled]="isLoading"
                            class="px-4 py-2 bg-teal-600 text-white rounded-md text-sm font-medium hover:bg-teal-700 disabled:opacity-50">
                            {{ isLoading ? 'Saving...' : (isEditing ? 'Update Patient' : 'Register Patient') }}
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>